{"id":"bd-1me","title":"AIML-430 - Fail action when Contrast-provided LLM trial is expired","description":"## Problem\nThe GitHub Action exits with success (code 0) when a Contrast-provided LLM trial license is expired, even though no fixes were generated. The error message is misleading (says 'PR limit' when it's actually trial expiration).\n\n## Root Cause\nThe backend returns HTTP 409 for multiple conditions with different messages:\n- PR limit: `MaxPrLimitException` → \"Maximum pull request limit exceeded\"\n- Credits exhausted: `RemediationCreditException` → \"Credits have been exhausted...\"\n- Trial expired: `RemediationCreditException` (via `hasEligibleCreditsAvailable()` checking `endDate`)\n\nBut `contrast_api.py:90-92` ignores the response body and logs generic \"At or over the maximum PR limit\" for ALL 409s.\n\n## Solution\n1. Parse the 409 response body to get the actual error message from the backend\n2. Display the backend's message (which is specific to the actual problem)\n3. Color the error message red using existing `\\033[31m`\n4. Exit with code 1 (failure) instead of silently succeeding\n\n## Optional Enhancement\nAdd client-side `is_expired` check in `CreditTrackingResponse` for early detection before API call.\n\n## Error Message Requirements\n- Display the actual error message from the backend response body\n- Use existing red error color: `\\033[31m`\n- Exit with failure code 1\n\n## Files\n- `src/contrast_api.py` - Parse 409 response body, display actual message\n- `src/main.py` - Ensure proper exit on credit/trial errors","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2026-02-04T14:33:20.501696Z","created_by":"Chris Edwards","updated_at":"2026-02-04T14:45:00.706106Z","external_ref":"AIML-430","source_repo":".","deleted_at":"2026-02-04T14:45:00.706089Z","deleted_by":"Chris Edwards","delete_reason":"delete","original_type":"bug","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-04e","title":"Remove find_open_pr_for_issue() and clean up","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T15:21:40.041100Z","updated_at":"2026-01-14T16:33:05.635180Z","closed_at":"2026-01-14T16:33:05.635180Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-0dj","title":"Create shared test helper modules","description":"Create test_helpers/ directory with agent_patches.py, build_patches.py, api_patches.py, common_patches.py containing reusable patch lists for consistent mocking across test files.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-05T19:34:30.374819Z","updated_at":"2026-01-05T20:35:09.050783Z","closed_at":"2026-01-05T20:35:09.050783Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-1zq","title":"Rename get_copilot_workflow_run_id to get_copilot_workflow_metadata","description":"Rename method to reflect it returns both run_id AND head_branch. Update all callers and tests","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:40.758422Z","updated_at":"2026-01-13T20:49:33.399141Z","closed_at":"2026-01-13T20:49:33.399141Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-31m","title":"Improve Build/Test Workflow test coverage (19-27% → 70%)","description":"Add comprehensive tests for build_runner.py and formatter.py. Cover build execution, output capture, timeouts, formatter execution and graceful degradation. Test command validation security.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-05T19:34:31.598607Z","updated_at":"2026-01-05T20:46:45.143289Z","closed_at":"2026-01-05T20:46:45.143289Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-31m","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"},{"issue_id":"contrast-ai-smartfix-action-31m","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-56n","title":"Update ScmOperations abstract base class signature","description":"Add remediation_id parameter to count_open_prs_with_prefix() in scm_operations.py abstract base class. Update docstring.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T20:51:36.044946Z","updated_at":"2026-01-09T21:31:54.104965Z","closed_at":"2026-01-09T21:30:53.519540Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-61p","title":"Improve Entry Point test coverage (32% → 60%)","description":"Add comprehensive tests for main.py orchestration. Cover SmartFix agent workflow, external agent workflows (Copilot/Claude), merge/closed handlers, version checking, config validation, top-level error handling.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-05T19:34:32.677110Z","updated_at":"2026-01-10T01:21:05.352077Z","closed_at":"2026-01-06T21:21:19.536285Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-61p","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"},{"issue_id":"contrast-ai-smartfix-action-61p","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-620","title":"Add input validation for author parameter","description":"Validate author parameter in get_issue_comments to prevent jq filter injection. Use GitHub username regex validation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:07.038474Z","updated_at":"2026-01-13T20:55:49.804091Z","closed_at":"2026-01-13T20:55:49.804091Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-6u0","title":"Fix count_open_prs_with_prefix() auth error handling","description":"Update github_operations.py:270-306 to detect 401/403 auth errors, log multiline error with remediation steps, call error_exit() instead of returning 0. Add remediation_id parameter.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-09T20:51:35.569763Z","updated_at":"2026-01-09T21:33:10.909972Z","closed_at":"2026-01-09T21:32:05.601787Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-6u0","depends_on_id":"contrast-ai-smartfix-action-56n","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-8md","title":"Add get_copilot_workflow_run_id() method","description":"Implement get_copilot_workflow_run_id() in github_operations.py to find Copilot workflow runs and extract headBranch. Returns (run_id, head_branch) tuple. Searches for 'Copilot coding agent' workflow name.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-09T20:51:22.366885Z","updated_at":"2026-01-09T21:30:42.242114Z","closed_at":"2026-01-09T21:15:01.595799Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-8re","title":"Integrate validation into Config class","description":"Integrate command validation into src/config.py Config.__init__():\n- Import command_validator module\n- Add _validate_command() method to Config class\n- Call validation for BUILD_COMMAND after reading from environment (line ~82)\n- Call validation for FORMATTING_COMMAND after reading from environment (line ~84)\n- Ensure CommandValidationError is caught and converted to ConfigurationError\n- Follow existing config validation patterns (similar to _check_contrast_config_values_exist)\n- Maintain fail-fast behavior with clear error messages\n\nRelated to JIRA: AIML-337","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:50:37.859629Z","updated_at":"2025-12-23T15:34:27.554600Z","closed_at":"2025-12-23T15:34:27.554600Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-8re","depends_on_id":"contrast-ai-smartfix-action-gad","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-9c5","title":"Optimize API call performance - cache issue timestamps","description":"Cache issue timestamps in get_copilot_workflow_run_id to avoid fetching on every polling attempt. Reduces API calls by 50%","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:01.445574Z","updated_at":"2026-01-13T21:05:14.939149Z","closed_at":"2026-01-13T21:05:14.939149Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-9hu","title":"Improve API Integration test coverage (28-66% → 70%)","description":"Add comprehensive tests for contrast_api.py, closed_handler.py, merge_handler.py. Cover HTTP error handling, timeouts, credit tracking, PR event handling, remediation status notifications.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-05T19:34:32.133956Z","updated_at":"2026-01-05T20:59:37.520196Z","closed_at":"2026-01-05T20:59:37.520196Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-9hu","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"},{"issue_id":"contrast-ai-smartfix-action-9hu","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-bz1","title":"Extract magic numbers to constants","description":"Create src/constants.py with GITHUB_MAX_PR_BODY_SIZE, GITHUB_MAX_ISSUE_BODY_SIZE. Update all references","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:35.115831Z","updated_at":"2026-01-13T20:48:19.363491Z","closed_at":"2026-01-13T20:48:19.363491Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-c1g","title":"Add authentication error test coverage","description":"Add tests for count_open_prs_with_prefix auth error handling: 401/403 errors trigger error_exit, non-auth errors return 0, remediation steps in error message","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:41:50.275714Z","updated_at":"2026-01-13T21:02:14.944961Z","closed_at":"2026-01-13T21:02:14.944961Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-cpi","title":"Improve SCM Operations test coverage (38-68% → 75%)","description":"Expand tests for github_operations.py (38% → 75%), fill gaps in git_operations.py and scm_operations.py. Focus on GitHub-specific operations: PR/issue creation, labels, GraphQL queries.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-05T19:34:33.129041Z","updated_at":"2026-01-10T01:21:05.350137Z","closed_at":"2026-01-06T21:38:37.943404Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-cpi","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"},{"issue_id":"contrast-ai-smartfix-action-cpi","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-d50","title":"Handle GitHub Actions workflow approval requirements","description":"Issue #377 failed because Copilot workflow was waiting for manual approval. SmartFix polled 100 times but never found the workflow. Need to detect approval-required state and fail gracefully with helpful error message instead of timing out.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-13T15:51:30.382992Z","updated_at":"2026-01-14T20:37:49.548418Z","closed_at":"2026-01-14T20:37:49.548418Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-dtc","title":"Test event_loop_utils.py (13% → 70%)","description":"Add comprehensive tests for event_loop_utils.py async event loop management.\n\nCurrent coverage: 13%\nTarget: 70%\n\nCritical paths:\n- _run_agent_in_event_loop: event loop creation/cleanup, platform-specific setup (Windows vs Unix)\n- Agent execution with success/exceptions/timeouts\n- Event loop cleanup on errors\n- Multiple sequential agent runs\n\nTest cases:\n- Successful agent execution\n- Agent exception handling with cleanup\n- Timeout scenarios\n- Platform-specific behavior (Windows ProactorEventLoop)\n- Event loop contamination prevention\n\nMocking:\n- Agent execution (LLM calls)\n- asyncio.new_event_loop, asyncio.set_event_loop\n- platform.system\n- File operations\n\nReference: docs/plans/2026-01-05-test-coverage-improvement-design.md lines 100-135","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T21:38:21.109343Z","updated_at":"2026-01-06T18:07:30.132100Z","closed_at":"2026-01-06T18:07:30.132100Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-e0r","title":"Test sub_agent_executor.py (50% → 70%)","description":"Add comprehensive tests for sub_agent_executor.py sub-agent orchestration logic.\n\nCurrent coverage: 50%\nTarget: 70%\n\nCritical paths:\n- Spawning sub-agents\n- Collecting results\n- Handling sub-agent failures\n- Timeout management\n\nTest cases:\n- Execute sub-agent successfully\n- Sub-agent throws exception (isolation)\n- Sub-agent timeout\n- Multiple parallel sub-agents\n- Result aggregation\n\nMocking:\n- LLM client calls\n- Agent execution\n- All I/O operations\n\nReference: docs/plans/2026-01-05-test-coverage-improvement-design.md lines 136-157","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T21:38:36.097839Z","updated_at":"2026-01-10T01:21:05.351491Z","closed_at":"2026-01-06T21:07:23.475848Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-e0r","depends_on_id":"contrast-ai-smartfix-action-uoy","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-gad","title":"Create command validation module","description":"Create src/smartfix/config/command_validator.py with:\n- ALLOWED_COMMANDS constant (full allowlist for Java, .NET, Python, PHP, NodeJS, build tools, shell utilities)\n- BLOCKED_PATTERNS regex list (command substitution, eval, exec, dangerous operations)\n- validate_shell_command() - ensures sh/bash only execute .sh files, blocks -c flag\n- validate_redirect() - allows relative paths only, blocks absolute paths and .. traversal\n- contains_dangerous_patterns() - checks command against blocked patterns\n- split_command_chain() - parses commands by operators (&&, ||, ;, |)\n- parse_command_segment() - extracts executable and arguments from command segment\n- extract_redirects() - finds file redirects in command\n- validate_command() - main validation function that orchestrates all checks\n- CommandValidationError exception class\n\nRelated to JIRA: AIML-337","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:49:50.169966Z","updated_at":"2025-12-23T15:28:03.234049Z","closed_at":"2025-12-23T15:28:03.234049Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-gnt","title":"Add coverage target to Makefile","description":"Add 'make coverage' target to run tests with coverage.py and generate HTML reports. This is a prerequisite for all other test work.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-05T19:34:17.897050Z","updated_at":"2026-01-05T19:54:39.771242Z","closed_at":"2026-01-05T19:54:39.771242Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-i17","title":"Remove --label flag from gh issue create command","description":"The gh issue create command fails with 'GraphQL: Resource not accessible by personal access token (repository.defaultBranchRef)' when using --label flag. Need to apply the same workaround used for PR creation: create issue first, then add labels separately using add_labels_to_issue() or similar method.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-12T21:33:41.033244Z","updated_at":"2026-01-12T21:37:01.715572Z","closed_at":"2026-01-12T21:37:01.715572Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-iuo","title":"Improve Agent Orchestration test coverage (10-27% → 70%)","description":"Add comprehensive tests for smartfix_agent.py, event_loop_utils.py, sub_agent_executor.py, mcp_manager.py. Focus on remediation workflow, async event loops, sub-agent execution, and MCP connection lifecycle. Use full mocking pattern.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-05T19:34:31.000974Z","updated_at":"2026-01-05T21:38:48.182515Z","closed_at":"2026-01-05T21:38:48.182515Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-iuo","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"},{"issue_id":"contrast-ai-smartfix-action-iuo","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-j7y","title":"Refactor _process_external_coding_agent_run() for Copilot","description":"Update external_coding_agent.py:294-296 to call _process_copilot_workflow_run() instead of find_open_pr_for_issue(). Remove pattern matching approach.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T20:51:35.025354Z","updated_at":"2026-01-09T21:30:42.242716Z","closed_at":"2026-01-09T21:29:50.861094Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-j7y","depends_on_id":"contrast-ai-smartfix-action-oya","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-kj2","title":"Update all count_open_prs_with_prefix() callers","description":"Find and update all callers of count_open_prs_with_prefix() to pass remediation_id parameter. Update main.py and any other files.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T20:51:36.580138Z","updated_at":"2026-01-13T14:42:25.758004Z","closed_at":"2026-01-13T14:42:25.758004Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-kj2","depends_on_id":"contrast-ai-smartfix-action-56n","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"},{"issue_id":"contrast-ai-smartfix-action-kj2","depends_on_id":"contrast-ai-smartfix-action-6u0","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-oub","title":"Sanitize error messages to prevent info disclosure","description":"Create safe_error_log function to sanitize tokens, paths, and sensitive data from error messages before logging","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:12.648478Z","updated_at":"2026-01-13T20:58:57.268715Z","closed_at":"2026-01-13T20:58:57.268715Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-oya","title":"Add _process_copilot_workflow_run() method","description":"Implement _process_copilot_workflow_run() in external_coding_agent.py. Watch Copilot workflow completion, get actual branch, find PR using headBranch. Reuses watch_github_action_run().","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-09T20:51:34.459928Z","updated_at":"2026-01-09T21:30:42.243241Z","closed_at":"2026-01-09T21:28:49.345167Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-oya","depends_on_id":"contrast-ai-smartfix-action-8md","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-p4l","title":"Implement graceful degradation for formatter failures","description":"Code review identified that formatter.py calls error_exit() on all failures, but the design plan requires graceful degradation (log warning and continue). Formatter should be best-effort - if it fails, log a warning and allow the remediation to continue. This aligns with industry best practices where formatters are optional quality-of-life tools.\n\nAffected file: src/smartfix/domains/workflow/formatter.py:75\nRequired changes:\n1. Replace error_exit() call with warning log\n2. Update tests to verify warnings instead of error_exit calls\n3. Add test for continued execution after formatter failure\n\nReference: Test Coverage Improvement Plan - Build/Test Workflow section","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-05T20:46:33.475021Z","updated_at":"2026-01-05T21:29:50.210724Z","closed_at":"2026-01-05T21:29:50.210728Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-q23","title":"Add TypedDict for dictionary return types","description":"Replace Optional[dict] with TypedDict for find_pr_by_branch and other methods returning GitHub API data structures","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:41:55.857344Z","updated_at":"2026-01-13T20:54:57.427843Z","closed_at":"2026-01-13T20:54:57.427843Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-q9y","title":"Create comprehensive test suite for command validation","description":"Create test/test_command_validation.py with comprehensive test coverage:\n- Test all allowed commands validate successfully (Java, .NET, Python, PHP, NodeJS, build tools)\n- Test blocked executables are rejected with proper error messages\n- Test command chaining with operators (&&, ||, ;, |)\n- Test shell script execution: sh/bash with .sh files allowed, -c flag blocked\n- Test redirect validation: relative paths pass, absolute paths and .. traversal fail\n- Test dangerous pattern detection: command substitution, eval, exec, piping to shell\n- Test edge cases: empty commands, whitespace, special characters, complex chains\n- Test error messages are clear and actionable\n- Ensure all tests pass and maintain existing test coverage (165+ tests)\n\nRelated to JIRA: AIML-337","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:51:20.598647Z","updated_at":"2025-12-23T15:35:10.539090Z","closed_at":"2025-12-23T15:35:10.539090Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-q9y","depends_on_id":"contrast-ai-smartfix-action-8re","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"},{"issue_id":"contrast-ai-smartfix-action-q9y","depends_on_id":"contrast-ai-smartfix-action-gad","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-r1k","title":"Fix Copilot workflow matching to use issue creation time","description":"get_copilot_workflow_run_id() returns most recent workflow without checking if it was created after the issue. This causes wrong labels when processing multiple issues concurrently. Fix: Get issue createdAt timestamp and filter workflows to only those created after the issue.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-13T14:49:55.706456Z","updated_at":"2026-01-13T14:53:19.316781Z","closed_at":"2026-01-13T14:53:19.316781Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-rhm","title":"Use updatedAt instead of createdAt for workflow matching","description":"Change get_copilot_workflow_run_id() to use issue.updatedAt instead of createdAt. This captures the @copilot assignment event and is more accurate for when Copilot actually starts working.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T14:59:20.267808Z","updated_at":"2026-01-13T15:00:40.469323Z","closed_at":"2026-01-13T15:00:40.469323Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-rne","title":"Fix GitHub issue creation body escaping","description":"Fix gh issue create command failure by using --body-file pattern instead of --body. The issue body text bleeds into command arguments when it contains multi-line content or special characters. Mirror the proven pattern from create_claude_pr() method.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-12T20:48:04.268086Z","updated_at":"2026-01-12T20:54:32.793134Z","closed_at":"2026-01-12T20:54:32.793134Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-tid","title":"Fix authorization bypass - fail closed on all errors","description":"Update count_open_prs_with_prefix to call error_exit on all API errors, not just auth errors. Prevents bypassing MAX_OPEN_PRS limits","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:18.249018Z","updated_at":"2026-01-13T20:56:33.869746Z","closed_at":"2026-01-13T20:56:33.869746Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-uoy","title":"Test smartfix_agent.py (25% → 70%)","description":"Add comprehensive tests for smartfix_agent.py remediation workflow state machine.\n\nCurrent coverage: 25%\nTarget: 70%\n\nCritical paths:\n- Initial build validation (pass/fail)\n- Fix agent execution (success/failure)\n- QA loop (success/retry/failure)\n- Session completion (all failure categories)\n\nTest cases:\n- Build fails before fix → INITIAL_BUILD_FAILURE\n- Fix agent succeeds, no build command → immediate success\n- Fix agent succeeds, QA passes → success\n- Fix agent succeeds, QA exhausts retries → QA_FAILURE\n- Fix agent throws exception → AGENT_FAILURE\n- Build never passes after fix → BUILD_FAILURE\n\nMocking:\n- _run_ai_fix_agent (return mock PR body or None)\n- _run_ai_qa_agent (return success/failure)\n- run_build_command (return success/failure + output)\n- All git operations\n\nReference: docs/plans/2026-01-05-test-coverage-improvement-design.md lines 78-99","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T21:38:29.814352Z","updated_at":"2026-01-06T19:43:29.354800Z","closed_at":"2026-01-06T19:43:29.354800Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-uoy","depends_on_id":"contrast-ai-smartfix-action-dtc","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-v7q","title":"Extract temp file handling to helper methods","description":"Create _write_to_temp_file and _cleanup_temp_file helpers. Refactor create_pr, create_claude_pr, create_issue to use helpers. Removes ~80 lines duplication","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:29.490013Z","updated_at":"2026-01-13T20:54:08.610376Z","closed_at":"2026-01-13T20:54:08.610376Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-wuv","title":"Update documentation for command allowlist","description":"Update README.md and related documentation:\n- Add new section explaining command allowlist security feature\n- Document all allowed commands organized by language/ecosystem\n- Document allowed operators for chaining (&&, ||, ;, |)\n- Document allowed redirect patterns (relative paths only)\n- Provide examples of valid commands for each language\n- Provide examples of blocked commands and why they fail\n- Document error messages users might encounter\n- Add troubleshooting section for common validation failures\n- Update security.md if present to mention this security feature\n\nRelated to JIRA: AIML-337","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T14:52:22.925762Z","updated_at":"2025-12-23T15:40:22.502328Z","closed_at":"2025-12-23T15:40:22.502328Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-wuv","depends_on_id":"contrast-ai-smartfix-action-q9y","type":"blocks","created_at":"2026-01-30T11:38:55Z","created_by":"import"}]}
{"id":"contrast-ai-smartfix-action-xs1","title":"Update documentation for fine-grained PAT permissions","description":"Update github_copilot.md and claude_code.md to include complete and accurate token permission requirements for fine-grained PATs. Add Contents (read-write) and Workflows (read) permissions that are currently missing.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T22:00:13.401461Z","updated_at":"2026-01-12T22:41:20.338025Z","closed_at":"2026-01-12T22:41:20.338025Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-yas","title":"Add tests for find_pr_by_branch method","description":"Add unit tests: success case, not found, JSON decode error, command error, empty response","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:23.860478Z","updated_at":"2026-01-13T21:03:25.511569Z","closed_at":"2026-01-13T21:03:25.511569Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-z4l","title":"Create LLM-as-judge prompt for E2E test repo PR reviews","description":"Create a reusable code review prompt for evaluating SmartFix's cybersecurity fixes in E2E test repos.\n\nPROMPT STRUCTURE:\n1. **Discovery Phase**\n   - Fetch open PRs using gh CLI\n   - Identify PRs created by SmartFix\n   - Extract vulnerability description from PR body\n   - Identify vulnerability type (SQL injection, XSS, path traversal, etc.)\n\n2. **Evaluation Criteria (Vulnerability-Agnostic)**\n   - Does the fix address the specific vulnerability described in PR body?\n   - Are all attack vectors for that vulnerability type blocked?\n   - Input validation appropriate for the vulnerability type\n   - Output encoding/sanitization where needed\n   - No introduction of new vulnerabilities\n   - Test coverage for the specific vulnerability\n\n3. **Review Process**\n   - Parse PR body to understand the vulnerability\n   - Fetch PR diff and files changed\n   - Analyze if code changes eliminate the vulnerability\n   - Check for incomplete fixes or edge cases\n   - **CRITICAL: If any problems are flagged:**\n     - Read surrounding code context (not just the diff)\n     - Trace the data flow to confirm the vulnerability path\n     - Verify the issue truly exists before reporting it\n     - Check if existing code already handles the concern\n     - Avoid false positives by validating assumptions\n   - Verify test cases cover the vulnerability scenario\n   - Assess if fix follows security best practices for that vuln type\n\n4. **Report Format**\n   - Vulnerability type and description (from PR)\n   - Fix effectiveness assessment\n   - Does fix address the vulnerability? (YES/NO/PARTIAL)\n   - Strengths of the fix\n   - Gaps or weaknesses in the fix (ONLY if confirmed by reading surrounding code)\n   - Attack vectors still exploitable (if any, with code evidence)\n   - Test coverage assessment\n   - Recommendations for improvement\n\nLOCATION:\ntest/prompts/smartfix-security-review.md\n\nUSAGE:\nUser runs Claude Code in E2E test repo and provides the prompt, which instructs Claude to review all open SmartFix PRs by matching code changes against the vulnerability described in each PR body.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T18:12:19.227567Z","updated_at":"2025-12-23T18:52:04.993954Z","closed_at":"2025-12-23T18:52:04.993954Z","source_repo":".","compaction_level":0,"original_size":0}

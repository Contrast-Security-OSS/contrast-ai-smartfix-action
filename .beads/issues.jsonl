{"id":"contrast-18b","title":"Stage 2: boto3 update (1.38.19 → 1.42.48)","description":"Branch: AIML-458_dependency-upgrades\n\nFILE CHANGES (src/requirements.txt):\n  boto3==1.38.19 → boto3==1.42.48\n\nAfter editing requirements.txt, regenerate the lock file:\n  uv pip compile src/requirements.txt -o src/requirements.lock\n\nTESTING GATE (all required before commit):\n  [ ] make test — all unit tests pass\n  [ ] make lint — no lint errors\n  [ ] Manual smoke test with AWS Bedrock provider (if credentials available):\n        configure LLM_PROVIDER=bedrock, trigger SmartFix, confirm fix PR created\n  [ ] Verify AWS credential handling works (no auth regressions)\n  [ ] Check botocore version pulled in — scan for deprecated API calls if changed\n\nNOTES: boto3 updates frequently; botocore is pinned transitively.\nROLLBACK: Revert src/requirements.txt boto3 line only.\nCOMMIT: Only after all gate items checked.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-18T23:23:18.187082Z","created_by":"jacobmages-haskins","updated_at":"2026-02-19T18:33:56.257627Z","closed_at":"2026-02-19T18:33:56.257616Z","close_reason":"Merged via PR #103","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-18b","depends_on_id":"contrast-1i6","type":"blocks","created_at":"2026-02-19T19:58:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-18n","title":"Stage 1: Low-risk dependency bumps","description":"test","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-18T22:15:08.343712Z","created_by":"jacobmages-haskins","updated_at":"2026-02-18T22:15:12.568799Z","closed_at":"2026-02-18T22:15:12.568785Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-1e7","title":"AIML-482 - Create directory_tree_utils.py","description":"Copy src/smartfix/domains/agents/directory_tree_utils.py from PR #99 into this branch.\n\nThe file contains three functions:\n  - get_directory_tree(repo_root, max_depth=3, max_chars=8000): tries 'tree' CLI; falls back to generate_simple_tree()\n  - generate_simple_tree(path, max_depth, current_depth=0, prefix=\"\"): pure-Python recursive tree generator; skips .git, __pycache__, node_modules, .venv, venv, target, build, dist, *.pyc, .pytest_cache\n  - get_directory_tree_for_agent_prompt(repo_root, max_depth=3, max_chars=8000): wraps tree in '## Repository Directory Tree\\n```\\n...\\n```'\n\nSource: https://github.com/Contrast-Security-OSS/contrast-ai-smartfix-action/pull/99\nFile: src/smartfix/domains/agents/directory_tree_utils.py (133 lines in PR #99)\n\nTESTING GATE:\n  [ ] File created at correct path\n  [ ] make lint — no lint errors","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-23T18:31:59.486285Z","created_by":"jacobmages-haskins","updated_at":"2026-02-23T18:39:24.710060Z","closed_at":"2026-02-23T18:39:24.710041Z","close_reason":"File created, committed, lint clean","external_ref":"AIML-482","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-1i6","title":"Stage 1: Low-risk deps (requests, google-generativeai, deprecated, packaging)","description":"Branch: AIML-458_dependency-upgrades\n\nFILE CHANGES (src/requirements.txt):\n  requests==2.32.4          → requests==2.32.5\n  google-generativeai==0.8.5 → google-generativeai==0.8.6\n  deprecated==1.2.14         → deprecated==1.3.1\n  packaging==25.0             → packaging==26.0\n\nAfter editing requirements.txt, regenerate the lock file:\n  uv pip compile src/requirements.txt -o src/requirements.lock\n\nTESTING GATE (all required before commit):\n  [ ] make test — all unit tests pass\n  [ ] make lint — no lint errors\n  [ ] Manual smoke test: trigger SmartFix on a test repo; confirm fix PR is created\n  [ ] Telemetry attributes appear correctly in the smoke test PR\n\nROLLBACK: Revert src/requirements.txt changes only.\nCOMMIT: Only after all gate items checked.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-18T22:15:28.318483Z","created_by":"jacobmages-haskins","updated_at":"2026-02-19T19:58:05.795043Z","closed_at":"2026-02-19T19:58:05.794989Z","close_reason":"Merged via PR #102","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-1xj","title":"Stage 5b: google-adk incremental update (1.15.0 → 1.20.0)","description":"Branch: AIML-458_dependency-upgrades\nDepends on: Stage 5a (google-adk at 1.15.0, tests passing)\n\nFILE CHANGES (src/requirements.txt):\n  google-adk==1.15.0 → google-adk==1.20.0\n\nAfter editing requirements.txt, regenerate the lock file:\n  uv pip compile src/requirements.txt -o src/requirements.lock\n\nREVIEW FIRST: Read google-adk changelog from 1.15.0 to 1.20.0 before making changes.\nSame key files to audit as Stage 5a.\n\nTESTING GATE (all required before commit):\n  [ ] make test — all unit tests pass\n  [ ] make lint — no lint errors\n  [ ] Manual smoke test: trigger SmartFix end-to-end, confirm fix PR created\n  [ ] Verify MCPToolset still creates and connects correctly\n  [ ] Verify tool calling works (agent reads/writes files via MCP)\n  [ ] Verify error handling behavior unchanged (agent failure modes)\n  [ ] Verify async operations work correctly (no new event loop issues)\n\nBREAKING CHANGE WATCH: Same areas as 5a — MCPToolset, Agent API, asyncio.\nROLLBACK: Revert google-adk to 1.15.0 and regenerate lock file.\nCOMMIT: Only after all gate items checked.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-18T23:32:55.251058Z","created_by":"jacobmages-haskins","updated_at":"2026-02-23T18:35:49.948659Z","closed_at":"2026-02-23T18:35:49.948596Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-1xj","depends_on_id":"contrast-cw3","type":"blocks","created_at":"2026-02-18T23:54:16Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-29q","title":"AIML-482 - Update smartfix_agent.py to append directory tree to Fix and QA prompts","description":"Add the directory tree import and two call sites to smartfix_agent.py.\n\nCHANGES:\n1. Add import near top of file (with other local imports):\n     from .directory_tree_utils import get_directory_tree_for_agent_prompt\n\n2. In _run_fix_agent_execution(): append tree to fix_user_prompt before passing to _run_agent_in_event_loop():\n     directory_tree = get_directory_tree_for_agent_prompt(context.repo_config.repo_path)\n     fix_user_prompt_with_tree = context.prompts.fix_user_prompt + directory_tree\n     (pass fix_user_prompt_with_tree instead of context.prompts.fix_user_prompt)\n\n3. In _run_qa_agent(): append tree to qa_query before passing to _run_agent_in_event_loop():\n     directory_tree = get_directory_tree_for_agent_prompt(context.repo_config.repo_path)\n     qa_query_with_tree = qa_query + directory_tree\n     (pass qa_query_with_tree instead of qa_query)\n\nTESTING GATE:\n  [ ] make lint — no lint errors\n  [ ] make test — all tests pass (existing test_smartfix_agent.py must still pass)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-23T18:33:42.650859Z","created_by":"jacobmages-haskins","updated_at":"2026-02-23T18:49:10.382872Z","closed_at":"2026-02-23T18:49:10.382855Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-29q","depends_on_id":"contrast-1e7","type":"blocks","created_at":"2026-02-23T18:34:54.072430Z","created_by":"jacobmages-haskins","metadata":"{}","thread_id":""}]}
{"id":"contrast-2n9","title":"Stage 4: uv package manager update (0.7.15 → 0.10.2)","description":"Branch: AIML-458_dependency-upgrades\n\nFILE CHANGES:\n  .github/workflows/build.yml — two occurrences:\n    pip install uv==0.7.15 → pip install uv==0.10.2  (Linux/macOS step)\n    pip install uv==0.7.15 → pip install uv==0.10.2  (Windows step)\n  action.yml — one occurrence:\n    pip install uv==0.7.15 → pip install uv==0.10.2\n\nALSO CHECK:\n  - uv 0.10 changed its lock file format; regenerate src/requirements.lock\n    using the new uv version:  uv pip compile src/requirements.txt -o src/requirements.lock\n  - Verify 'uv pip sync --system' still works (uv 0.8+ changed --system semantics)\n  - Check if any uv CLI flags changed between 0.7 and 0.10\n\nTESTING GATE (all required before commit):\n  [ ] Push branch and verify CI/CD pipeline passes end-to-end on GitHub Actions\n  [ ] Confirm dependency installation step completes without errors in CI logs\n  [ ] Confirm lock file generation produces valid output\n  [ ] make test — all unit tests pass locally with new uv\n  [ ] Local development environment still works after updating uv locally\n\nNOTES: uv 0.7→0.10 had significant changes to lock file format and resolution algo.\nROLLBACK: Revert the three version strings in build.yml and action.yml.\nCOMMIT: Only after all gate items checked.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-18T23:28:39.733530Z","created_by":"jacobmages-haskins","updated_at":"2026-02-20T19:52:48.761009Z","closed_at":"2026-02-20T19:52:48.760947Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-2n9","depends_on_id":"contrast-3ot","type":"blocks","created_at":"2026-02-18T23:54:16Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-3js","title":"Stage 5c: google-adk incremental update (1.20.0 → 1.25.0) — CRITICAL","description":"Branch: AIML-458_dependency-upgrades\nDepends on: Stage 5b (google-adk at 1.20.0, tests passing)\n\nFILE CHANGES (src/requirements.txt):\n  google-adk==1.20.0 → google-adk==1.25.0\n\nAfter editing requirements.txt, regenerate the lock file:\n  uv pip compile src/requirements.txt -o src/requirements.lock\n\nREVIEW FIRST: Read google-adk changelog from 1.20.0 to 1.25.0 before making changes.\nSame key files to audit as 5a/5b, plus check for any newly deprecated features removed.\n\nTESTING GATE (all required before commit — most thorough of all stages):\n  [ ] make test — all unit tests pass\n  [ ] make lint — no lint errors\n  [ ] Manual smoke test #1: Gemini provider — full end-to-end fix PR created\n  [ ] Manual smoke test #2: Trigger on a multi-file vulnerability if possible\n  [ ] Verify MCPToolset creation works (no API signature changes)\n  [ ] Verify tool calling works (read, write, directory operations)\n  [ ] Verify error handling behavior unchanged (bad input, network error scenarios)\n  [ ] Verify async operations work correctly\n  [ ] Check if Windows-specific asyncio patches in src/main.py still needed\n  [ ] Confirm no new required dependencies introduced by ADK 1.25\n\nBREAKING CHANGE WATCH: API signature changes, new required params, deprecated features removed,\n  changed default behaviors, new transitive dependencies.\nFILES LIKELY NEEDING UPDATES:\n  - src/smartfix/domains/agents/mcp_manager.py — MCPToolset usage\n  - src/main.py — agent lifecycle, asyncio handling\nROLLBACK: Revert google-adk to 1.20.0 and regenerate lock file.\nCOMMIT: Only after all gate items checked.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-18T23:33:42.899938Z","created_by":"jacobmages-haskins","updated_at":"2026-02-23T18:36:42.054414Z","closed_at":"2026-02-23T18:36:42.054330Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-3js","depends_on_id":"contrast-1xj","type":"blocks","created_at":"2026-02-18T23:54:16Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-3k9","title":"Stage 6: Python 3.11 → 3.13.9 in CI/CD and action","description":"Branch: AIML-458_dependency-upgrades\nDepends on: Stage 5c (google-adk stable at 1.25.0)\n\nFILE CHANGES:\n  .github/workflows/build.yml:\n    python-version: '3.11' → python-version: '3.13'\n    (GitHub Actions uses setup-python@v5 which supports 3.13)\n  action.yml:\n    python-version: '3.11' → python-version: '3.13'\n    (Search for all occurrences: grep -n 'python-version\\|3\\.11' action.yml)\n\nINVESTIGATE BEFORE CHANGING:\n  1. Check if 'uv pip sync --system' still works with Python 3.13.\n     Python 3.11+ systems may require --break-system-packages or a venv.\n     With uv, --system bypasses this — confirm uv 0.10.2 + Python 3.13 still allows --system.\n  2. Check src/main.py for asyncio-related patches (e.g. WindowsProactorEventLoopPolicy).\n     Python 3.12+ changed asyncio defaults; verify no patches are broken or now redundant.\n  3. Check for any use of removed Python 3.11 features (e.g. deprecated typing constructs).\n     Run: python3.13 -m py_compile src/main.py src/smartfix/domains/agents/mcp_manager.py\n  4. Verify all test files compile under 3.13.\n\nVENV QUESTION (investigate in CI):\n  The current workflow runs 'uv pip sync --system' without a venv.\n  Python 3.13 on some systems enforces PEP 668 (externally managed environments).\n  uv --system should still bypass this, but confirm in CI logs after first push.\n  If CI fails with 'externally-managed-environment' error, create a venv step:\n    uv venv .venv && uv pip sync --python .venv/bin/python src/requirements.lock\n  Then update the run commands to use .venv/bin/python instead of 'python'.\n\nTESTING GATE (all required before commit):\n  [ ] Push branch with changes — verify GitHub Actions CI passes completely\n  [ ] make test locally with Python 3.13 (if installed) — all tests pass\n  [ ] make lint — no lint errors\n  [ ] Manual smoke test: full end-to-end with Python 3.13 runtime\n  [ ] Verify asyncio behavior unchanged (no new event loop errors in logs)\n  [ ] Confirm no deprecation warnings become errors under 3.13 strict mode\n\nROLLBACK: Revert python-version strings in build.yml and action.yml.\nCOMMIT: Only after all gate items checked, especially CI passing.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-18T23:34:03.979583Z","created_by":"jacobmages-haskins","updated_at":"2026-02-23T18:36:03.573765Z","closed_at":"2026-02-23T18:36:03.573687Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-3k9","depends_on_id":"contrast-3js","type":"blocks","created_at":"2026-02-18T23:54:16Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-3ot","title":"Stage 3: litellm update (1.77.5 → 1.81.10)","description":"Branch: AIML-458_dependency-upgrades\n\nFILE CHANGES (src/requirements.txt):\n  litellm==1.77.5 → litellm==1.81.10\n\nAfter editing requirements.txt, regenerate the lock file:\n  uv pip compile src/requirements.txt -o src/requirements.lock\n\nTESTING GATE (all required before commit):\n  [ ] make test — all unit tests pass\n  [ ] make lint — no lint errors\n  [ ] Manual smoke test: Gemini provider — trigger SmartFix with Gemini, confirm PR\n  [ ] Manual smoke test: Anthropic provider (if credentials available) — confirm PR\n  [ ] Manual smoke test: AWS Bedrock provider (if credentials available) — confirm PR\n  [ ] Manual smoke test: Azure OpenAI provider (if credentials available) — confirm PR\n  [ ] Verify token counting still works (no off-by-one in context windows)\n  [ ] Check for new required environment variables in litellm 1.78–1.81 changelog\n  [ ] Check for changed response format fields (especially .choices, .usage)\n\nBREAKING CHANGE WATCH: Review litellm changelog from 1.77.5 to 1.81.10 for:\n  - New required params, deprecated params, changed provider configs\n\nROLLBACK: Revert src/requirements.txt litellm line only.\nCOMMIT: Only after all gate items checked.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-18T23:27:18.335134Z","created_by":"jacobmages-haskins","updated_at":"2026-02-20T19:52:33.166170Z","closed_at":"2026-02-20T19:52:33.166105Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-3ot","depends_on_id":"contrast-18b","type":"blocks","created_at":"2026-02-18T23:54:16Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-3rk","title":"Stage 7: MCP server-filesystem NPM package update","description":"Branch: AIML-458_dependency-upgrades\nDepends on: Stage 6 (Python 3.13 stable)\n\nCURRENT VERSION:\n  src/smartfix/domains/agents/mcp_manager.py line ~84:\n    self.mcp_package = '@modelcontextprotocol/server-filesystem@2025.11.25'\n\nINVESTIGATE FIRST:\n  Check npm for the latest stable version:\n    npm view @modelcontextprotocol/server-filesystem versions --json\n  Review changelog at https://github.com/modelcontextprotocol/servers\n  Only update if a newer stable version is available.\n\nFILE CHANGES (if newer version exists):\n  src/smartfix/domains/agents/mcp_manager.py line ~84:\n    '@modelcontextprotocol/server-filesystem@2025.11.25'\n    → '@modelcontextprotocol/server-filesystem@<NEW_VERSION>'\n\nTESTING GATE (all required before commit):\n  [ ] make test — all unit tests pass (especially mcp_manager tests)\n  [ ] make lint — no lint errors\n  [ ] Manual smoke test: verify file read operations work (agent reads source files)\n  [ ] Manual smoke test: verify file write operations work (agent writes fix)\n  [ ] Verify directory listing operations work\n  [ ] Verify permission handling unchanged (no new access errors)\n  [ ] Confirm the npx invocation in mcp_manager.py still works with new version\n\nROLLBACK: Revert the mcp_package string to @2025.11.25.\nCOMMIT: Only after all gate items checked.\nNOTE: This stage is optional — skip if no newer stable version is available.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-18T23:34:17.058015Z","created_by":"jacobmages-haskins","updated_at":"2026-02-23T18:36:52.775299Z","closed_at":"2026-02-23T18:36:52.775236Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-3rk","depends_on_id":"contrast-3k9","type":"blocks","created_at":"2026-02-18T23:54:16Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-04e","title":"Remove find_open_pr_for_issue() and clean up","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T15:21:40.041100Z","updated_at":"2026-01-14T16:33:05.635180Z","closed_at":"2026-01-14T16:33:05.635180Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-0dj","title":"Create shared test helper modules","description":"Create test_helpers/ directory with agent_patches.py, build_patches.py, api_patches.py, common_patches.py containing reusable patch lists for consistent mocking across test files.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-05T19:34:30.374819Z","updated_at":"2026-01-05T20:35:09.050783Z","closed_at":"2026-01-05T20:35:09.050783Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-1zq","title":"Rename get_copilot_workflow_run_id to get_copilot_workflow_metadata","description":"Rename method to reflect it returns both run_id AND head_branch. Update all callers and tests","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:40.758422Z","updated_at":"2026-01-13T20:49:33.399141Z","closed_at":"2026-01-13T20:49:33.399141Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-31m","title":"Improve Build/Test Workflow test coverage (19-27% → 70%)","description":"Add comprehensive tests for build_runner.py and formatter.py. Cover build execution, output capture, timeouts, formatter execution and graceful degradation. Test command validation security.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-05T19:34:31.598607Z","updated_at":"2026-01-05T20:46:45.143289Z","closed_at":"2026-01-05T20:46:45.143289Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-31m","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-31m","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-3l4","title":"Create command_detection_orchestrator.py module","description":"Create new orchestrator module that coordinates Phase 1, Phase 2, and fallback logic. Implements detect_build_command_with_fallback() function that always returns a command string (real or NO_OP_BUILD_COMMAND constant).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-21T02:43:17.497657Z","updated_at":"2026-01-21T20:02:10.614158Z","closed_at":"2026-01-21T20:02:10.614158Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-44w","title":"Update README.md with auto-detection feature","description":"Document new auto-detection capability. Explain deterministic → LLM fallback flow, when detection runs (build_command=None or format_command=None), and how to override with explicit commands.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-16T02:46:53.193817Z","updated_at":"2026-01-16T20:50:17.979020Z","closed_at":"2026-01-16T20:50:17.979020Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-56n","title":"Update ScmOperations abstract base class signature","description":"Add remediation_id parameter to count_open_prs_with_prefix() in scm_operations.py abstract base class. Update docstring.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T20:51:36.044946Z","updated_at":"2026-01-09T21:31:54.104965Z","closed_at":"2026-01-09T21:30:53.519540Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-5bt","title":"Update supported-build-systems.md documentation","description":"Update docs/supported-build-systems.md: 1) Replace auto-detection section with three-phase approach, 2) Document Phase 1 runs builds, 3) Document Phase 2 LLM detection, 4) Document Phase 3 no-op fallback, 5) Document when detection is skipped.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-21T02:46:20.831076Z","updated_at":"2026-01-23T14:20:51.090987Z","closed_at":"2026-01-23T02:18:00Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-5bt","depends_on_id":"contrast-ai-smartfix-action-bnk","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-61p","title":"Improve Entry Point test coverage (32% → 60%)","description":"Add comprehensive tests for main.py orchestration. Cover SmartFix agent workflow, external agent workflows (Copilot/Claude), merge/closed handlers, version checking, config validation, top-level error handling.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-05T19:34:32.677110Z","updated_at":"2026-01-10T01:21:05.352077Z","closed_at":"2026-01-06T21:21:19.536285Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-61p","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-61p","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-620","title":"Add input validation for author parameter","description":"Validate author parameter in get_issue_comments to prevent jq filter injection. Use GitHub username regex validation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:07.038474Z","updated_at":"2026-01-13T20:55:49.804091Z","closed_at":"2026-01-13T20:55:49.804091Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-66d","title":"Write unit tests for Phase 1 changes","description":"Create/update test_command_detector.py to test: 1) detect_build_command() calls run_build_command(), 2) Returns command + empty failures on success, 3) Returns None + failure history when all fail, 4) Validation failures are skipped, 5) Mock run_build_command() to avoid slow builds.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-21T02:45:34.550742Z","updated_at":"2026-01-23T14:20:51.091961Z","closed_at":"2026-01-23T14:20:51.082619Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-66d","depends_on_id":"contrast-ai-smartfix-action-6dp","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-6dp","title":"Update Phase 1 to run builds and return failure history","description":"Modify detect_build_command() in command_detector.py to: 1) Run actual builds with run_build_command() instead of just checking --version, 2) Return tuple of (command, failed_attempts), 3) Collect error output for failures to pass to Phase 2.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-21T02:45:08.666642Z","updated_at":"2026-01-21T21:20:12.624966Z","closed_at":"2026-01-21T21:20:12.624966Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-6u0","title":"Fix count_open_prs_with_prefix() auth error handling","description":"Update github_operations.py:270-306 to detect 401/403 auth errors, log multiline error with remediation steps, call error_exit() instead of returning 0. Add remediation_id parameter.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-09T20:51:35.569763Z","updated_at":"2026-01-09T21:33:10.909972Z","closed_at":"2026-01-09T21:32:05.601787Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-6u0","depends_on_id":"contrast-ai-smartfix-action-56n","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-73f","title":"Create CommandDetectionAgent class","description":"Implement CommandDetectionAgent following SubAgentExecutor pattern (like QA agent). Include detect() method with iteration loop, _build_iteration_prompt() helper, and error feedback integration with extract_build_errors().","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T02:44:30.941318Z","updated_at":"2026-01-16T19:56:03.967745Z","closed_at":"2026-01-16T16:56:14.154067Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-7nf","title":"Create test suite for LLM agent (mocked)","description":"Write tests for CommandDetectionAgent class with mocked SubAgentExecutor. Test iteration logic, max_attempts boundary, error extraction, and successful detection scenarios.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-16T02:46:39.230758Z","updated_at":"2026-01-16T20:59:28.700996Z","closed_at":"2026-01-16T20:59:28.700996Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-8md","title":"Add get_copilot_workflow_run_id() method","description":"Implement get_copilot_workflow_run_id() in github_operations.py to find Copilot workflow runs and extract headBranch. Returns (run_id, head_branch) tuple. Searches for 'Copilot coding agent' workflow name.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-09T20:51:22.366885Z","updated_at":"2026-01-09T21:30:42.242114Z","closed_at":"2026-01-09T21:15:01.595799Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-8re","title":"Integrate validation into Config class","description":"Integrate command validation into src/config.py Config.__init__():\n- Import command_validator module\n- Add _validate_command() method to Config class\n- Call validation for BUILD_COMMAND after reading from environment (line ~82)\n- Call validation for FORMATTING_COMMAND after reading from environment (line ~84)\n- Ensure CommandValidationError is caught and converted to ConfigurationError\n- Follow existing config validation patterns (similar to _check_contrast_config_values_exist)\n- Maintain fail-fast behavior with clear error messages\n\nRelated to JIRA: AIML-337","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:50:37.859629Z","updated_at":"2025-12-23T15:34:27.554600Z","closed_at":"2025-12-23T15:34:27.554600Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-8re","depends_on_id":"contrast-ai-smartfix-action-gad","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-9c5","title":"Optimize API call performance - cache issue timestamps","description":"Cache issue timestamps in get_copilot_workflow_run_id to avoid fetching on every polling attempt. Reduces API calls by 50%","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:01.445574Z","updated_at":"2026-01-13T21:05:14.939149Z","closed_at":"2026-01-13T21:05:14.939149Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-9hu","title":"Improve API Integration test coverage (28-66% → 70%)","description":"Add comprehensive tests for contrast_api.py, closed_handler.py, merge_handler.py. Cover HTTP error handling, timeouts, credit tracking, PR event handling, remediation status notifications.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-05T19:34:32.133956Z","updated_at":"2026-01-05T20:59:37.520196Z","closed_at":"2026-01-05T20:59:37.520196Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-9hu","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-9hu","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-9tk","title":"Add error handling and clear error messages","description":"Implement ConfigurationError messages for: no build files found, max iterations exceeded, agent execution failure, validation failure. Include helpful suggestions in error messages.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T02:44:38.741072Z","updated_at":"2026-01-16T20:39:38.028824Z","closed_at":"2026-01-16T20:39:38.028824Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-9yb","title":"Update Phase 2 to return None instead of raising exception","description":"Modify CommandDetectionAgent.detect() to: 1) Accept Phase 1 failure history as input, 2) Return None when iterations exhausted instead of raising MaxAttemptsExceededError, 3) Log warning with failure context when exhausted.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-21T02:45:13.755584Z","updated_at":"2026-01-23T14:20:51.092696Z","closed_at":"2026-01-23T03:05:28.513669Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-air","title":"Create config integration tests","description":"Write tests for Config.__init__() detection integration. Test fallback to None when all detection fails, validate detected commands pass allowlist, verify config state after detection.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-16T02:46:39.688288Z","updated_at":"2026-01-16T20:42:42.782492Z","closed_at":"2026-01-16T20:42:42.782492Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-bcs","title":"Write unit tests for orchestrator","description":"Create test_command_detection_orchestrator.py to test: 1) Phase 1 success returns immediately (Phase 2 not called), 2) Phase 1 fails triggers Phase 2 with history, 3) Phase 2 success returns command, 4) Both fail returns NO_OP_BUILD_COMMAND, 5) Logging at transitions.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-21T02:45:50.873101Z","updated_at":"2026-01-23T14:20:51.093372Z","closed_at":"2026-01-22T03:16:30.680610Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-bcs","depends_on_id":"contrast-ai-smartfix-action-3l4","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-bnk","title":"Update Config.py to use orchestrator and skip when not required","description":"Modify Config.__init__ to: 1) Skip detection entirely when BUILD_COMMAND not required, 2) Call detect_build_command_with_fallback() when required, 3) Remove ConfigurationError raising for detection failures, 4) Always get valid command string (real or no-op).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-21T02:45:18.994363Z","updated_at":"2026-01-23T14:20:51.094073Z","closed_at":"2026-01-22T03:08:35.049462Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-bnk","depends_on_id":"contrast-ai-smartfix-action-3l4","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-bnk","depends_on_id":"contrast-ai-smartfix-action-6dp","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-bnk","depends_on_id":"contrast-ai-smartfix-action-9yb","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-bz1","title":"Extract magic numbers to constants","description":"Create src/constants.py with GITHUB_MAX_PR_BODY_SIZE, GITHUB_MAX_ISSUE_BODY_SIZE. Update all references","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:35.115831Z","updated_at":"2026-01-13T20:48:19.363491Z","closed_at":"2026-01-13T20:48:19.363491Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-c1g","title":"Add authentication error test coverage","description":"Add tests for count_open_prs_with_prefix auth error handling: 401/403 errors trigger error_exit, non-auth errors return 0, remediation steps in error message","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:41:50.275714Z","updated_at":"2026-01-13T21:02:14.944961Z","closed_at":"2026-01-13T21:02:14.944961Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-cpi","title":"Improve SCM Operations test coverage (38-68% → 75%)","description":"Expand tests for github_operations.py (38% → 75%), fill gaps in git_operations.py and scm_operations.py. Focus on GitHub-specific operations: PR/issue creation, labels, GraphQL queries.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-05T19:34:33.129041Z","updated_at":"2026-01-10T01:21:05.350137Z","closed_at":"2026-01-06T21:38:37.943404Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-cpi","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-cpi","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-d50","title":"Handle GitHub Actions workflow approval requirements","description":"Issue #377 failed because Copilot workflow was waiting for manual approval. SmartFix polled 100 times but never found the workflow. Need to detect approval-required state and fail gracefully with helpful error message instead of timing out.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-13T15:51:30.382992Z","updated_at":"2026-01-14T20:37:49.548418Z","closed_at":"2026-01-14T20:37:49.548418Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-dtc","title":"Test event_loop_utils.py (13% → 70%)","description":"Add comprehensive tests for event_loop_utils.py async event loop management.\n\nCurrent coverage: 13%\nTarget: 70%\n\nCritical paths:\n- _run_agent_in_event_loop: event loop creation/cleanup, platform-specific setup (Windows vs Unix)\n- Agent execution with success/exceptions/timeouts\n- Event loop cleanup on errors\n- Multiple sequential agent runs\n\nTest cases:\n- Successful agent execution\n- Agent exception handling with cleanup\n- Timeout scenarios\n- Platform-specific behavior (Windows ProactorEventLoop)\n- Event loop contamination prevention\n\nMocking:\n- Agent execution (LLM calls)\n- asyncio.new_event_loop, asyncio.set_event_loop\n- platform.system\n- File operations\n\nReference: docs/plans/2026-01-05-test-coverage-improvement-design.md lines 100-135","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T21:38:21.109343Z","updated_at":"2026-01-06T18:07:30.132100Z","closed_at":"2026-01-06T18:07:30.132100Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-e0r","title":"Test sub_agent_executor.py (50% → 70%)","description":"Add comprehensive tests for sub_agent_executor.py sub-agent orchestration logic.\n\nCurrent coverage: 50%\nTarget: 70%\n\nCritical paths:\n- Spawning sub-agents\n- Collecting results\n- Handling sub-agent failures\n- Timeout management\n\nTest cases:\n- Execute sub-agent successfully\n- Sub-agent throws exception (isolation)\n- Sub-agent timeout\n- Multiple parallel sub-agents\n- Result aggregation\n\nMocking:\n- LLM client calls\n- Agent execution\n- All I/O operations\n\nReference: docs/plans/2026-01-05-test-coverage-improvement-design.md lines 136-157","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T21:38:36.097839Z","updated_at":"2026-01-10T01:21:05.351491Z","closed_at":"2026-01-06T21:07:23.475848Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-e0r","depends_on_id":"contrast-ai-smartfix-action-uoy","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-e4d","title":"Add troubleshooting guide for detection failures","description":"Document common detection failures and fixes: unsupported build system (provide explicit command), monorepo confusion (use --prefix flags), Makefile without test target (create target or specify command), detection timeout (increase MAX_COMMAND_DETECTION_ATTEMPTS).","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-16T02:46:53.668828Z","updated_at":"2026-01-16T20:48:50.373163Z","closed_at":"2026-01-16T20:48:50.373163Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-ec6","title":"Integrate with command_validator.py","description":"Ensure all detected commands pass through validate_command() before testing. Handle CommandValidationError gracefully in both deterministic layer and LLM agent.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T02:44:38.592982Z","updated_at":"2026-01-16T20:29:29.360609Z","closed_at":"2026-01-16T20:29:29.360609Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-gad","title":"Create command validation module","description":"Create src/smartfix/config/command_validator.py with:\n- ALLOWED_COMMANDS constant (full allowlist for Java, .NET, Python, PHP, NodeJS, build tools, shell utilities)\n- BLOCKED_PATTERNS regex list (command substitution, eval, exec, dangerous operations)\n- validate_shell_command() - ensures sh/bash only execute .sh files, blocks -c flag\n- validate_redirect() - allows relative paths only, blocks absolute paths and .. traversal\n- contains_dangerous_patterns() - checks command against blocked patterns\n- split_command_chain() - parses commands by operators (&&, ||, ;, |)\n- parse_command_segment() - extracts executable and arguments from command segment\n- extract_redirects() - finds file redirects in command\n- validate_command() - main validation function that orchestrates all checks\n- CommandValidationError exception class\n\nRelated to JIRA: AIML-337","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:49:50.169966Z","updated_at":"2025-12-23T15:28:03.234049Z","closed_at":"2025-12-23T15:28:03.234049Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-gnt","title":"Add coverage target to Makefile","description":"Add 'make coverage' target to run tests with coverage.py and generate HTML reports. This is a prerequisite for all other test work.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-05T19:34:17.897050Z","updated_at":"2026-01-05T19:54:39.771242Z","closed_at":"2026-01-05T19:54:39.771242Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-i17","title":"Remove --label flag from gh issue create command","description":"The gh issue create command fails with 'GraphQL: Resource not accessible by personal access token (repository.defaultBranchRef)' when using --label flag. Need to apply the same workaround used for PR creation: create issue first, then add labels separately using add_labels_to_issue() or similar method.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-12T21:33:41.033244Z","updated_at":"2026-01-12T21:37:01.715572Z","closed_at":"2026-01-12T21:37:01.715572Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-iuo","title":"Improve Agent Orchestration test coverage (10-27% → 70%)","description":"Add comprehensive tests for smartfix_agent.py, event_loop_utils.py, sub_agent_executor.py, mcp_manager.py. Focus on remediation workflow, async event loops, sub-agent execution, and MCP connection lifecycle. Use full mocking pattern.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-05T19:34:31.000974Z","updated_at":"2026-01-05T21:38:48.182515Z","closed_at":"2026-01-05T21:38:48.182515Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-iuo","depends_on_id":"contrast-ai-smartfix-action-0dj","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-iuo","depends_on_id":"contrast-ai-smartfix-action-gnt","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-j7y","title":"Refactor _process_external_coding_agent_run() for Copilot","description":"Update external_coding_agent.py:294-296 to call _process_copilot_workflow_run() instead of find_open_pr_for_issue(). Remove pattern matching approach.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T20:51:35.025354Z","updated_at":"2026-01-09T21:30:42.242716Z","closed_at":"2026-01-09T21:29:50.861094Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-j7y","depends_on_id":"contrast-ai-smartfix-action-oya","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-kj2","title":"Update all count_open_prs_with_prefix() callers","description":"Find and update all callers of count_open_prs_with_prefix() to pass remediation_id parameter. Update main.py and any other files.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T20:51:36.580138Z","updated_at":"2026-01-13T14:42:25.758004Z","closed_at":"2026-01-13T14:42:25.758004Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-kj2","depends_on_id":"contrast-ai-smartfix-action-56n","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-kj2","depends_on_id":"contrast-ai-smartfix-action-6u0","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-kq7","title":"Create system prompt for command detection agent","description":"Write command_detection_system_prompt.txt in src/smartfix/domains/agents/prompts/ with ALLOWED_COMMANDS list, ecosystem patterns, monorepo handling, iteration strategy, and example scenarios.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T02:44:31.098692Z","updated_at":"2026-01-16T15:24:53.968335Z","closed_at":"2026-01-16T15:24:53.968335Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-l67","title":"Create comprehensive test suite for deterministic layer","description":"Write tests for generate_build_command_candidates(), inspect_makefile_targets(), and test_formatting_command() covering all supported build systems and file patterns.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-16T02:46:38.762944Z","updated_at":"2026-01-16T20:40:26.996201Z","closed_at":"2026-01-16T20:40:26.996201Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-n4r","title":"Add MAX_COMMAND_DETECTION_ATTEMPTS config setting","description":"Add MAX_COMMAND_DETECTION_ATTEMPTS to Config with _get_validated_int(). Default=6, min=0, max=10. Pass to CommandDetectionAgent.detect().","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T02:44:38.451637Z","updated_at":"2026-01-16T20:39:16.300864Z","closed_at":"2026-01-16T20:39:16.300864Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-ob2","title":"Write unit tests for Config.py changes","description":"Update test_config.py to test: 1) BUILD_COMMAND not required skips detection and sets None, 2) Required calls orchestrator, 3) Never raises ConfigurationError on detection failure, 4) Manual BUILD_COMMAND bypasses detection.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-21T02:45:58.823063Z","updated_at":"2026-01-23T14:20:51.094790Z","closed_at":"2026-01-23T01:30:00Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-ob2","depends_on_id":"contrast-ai-smartfix-action-bnk","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-oub","title":"Sanitize error messages to prevent info disclosure","description":"Create safe_error_log function to sanitize tokens, paths, and sensitive data from error messages before logging","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:12.648478Z","updated_at":"2026-01-13T20:58:57.268715Z","closed_at":"2026-01-13T20:58:57.268715Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-oya","title":"Add _process_copilot_workflow_run() method","description":"Implement _process_copilot_workflow_run() in external_coding_agent.py. Watch Copilot workflow completion, get actual branch, find PR using headBranch. Reuses watch_github_action_run().","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-09T20:51:34.459928Z","updated_at":"2026-01-09T21:30:42.243241Z","closed_at":"2026-01-09T21:28:49.345167Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-oya","depends_on_id":"contrast-ai-smartfix-action-8md","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-p4l","title":"Implement graceful degradation for formatter failures","description":"Code review identified that formatter.py calls error_exit() on all failures, but the design plan requires graceful degradation (log warning and continue). Formatter should be best-effort - if it fails, log a warning and allow the remediation to continue. This aligns with industry best practices where formatters are optional quality-of-life tools.\n\nAffected file: src/smartfix/domains/workflow/formatter.py:75\nRequired changes:\n1. Replace error_exit() call with warning log\n2. Update tests to verify warnings instead of error_exit calls\n3. Add test for continued execution after formatter failure\n\nReference: Test Coverage Improvement Plan - Build/Test Workflow section","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-05T20:46:33.475021Z","updated_at":"2026-01-05T21:29:50.210724Z","closed_at":"2026-01-05T21:29:50.210728Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-q23","title":"Add TypedDict for dictionary return types","description":"Replace Optional[dict] with TypedDict for find_pr_by_branch and other methods returning GitHub API data structures","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:41:55.857344Z","updated_at":"2026-01-13T20:54:57.427843Z","closed_at":"2026-01-13T20:54:57.427843Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-q9y","title":"Create comprehensive test suite for command validation","description":"Create test/test_command_validation.py with comprehensive test coverage:\n- Test all allowed commands validate successfully (Java, .NET, Python, PHP, NodeJS, build tools)\n- Test blocked executables are rejected with proper error messages\n- Test command chaining with operators (&&, ||, ;, |)\n- Test shell script execution: sh/bash with .sh files allowed, -c flag blocked\n- Test redirect validation: relative paths pass, absolute paths and .. traversal fail\n- Test dangerous pattern detection: command substitution, eval, exec, piping to shell\n- Test edge cases: empty commands, whitespace, special characters, complex chains\n- Test error messages are clear and actionable\n- Ensure all tests pass and maintain existing test coverage (165+ tests)\n\nRelated to JIRA: AIML-337","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:51:20.598647Z","updated_at":"2025-12-23T15:35:10.539090Z","closed_at":"2025-12-23T15:35:10.539090Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-q9y","depends_on_id":"contrast-ai-smartfix-action-8re","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"contrast-ai-smartfix-action-q9y","depends_on_id":"contrast-ai-smartfix-action-gad","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-qyu","title":"Document supported build systems and marker files","description":"Create table of: ecosystem, marker files, candidate commands, priority order. Include Maven, Gradle, Python, Node.js, .NET, PHP, Makefile, CMake examples.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-16T02:46:41.183139Z","updated_at":"2026-01-16T20:48:02.182115Z","closed_at":"2026-01-16T20:48:02.182115Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-r1k","title":"Fix Copilot workflow matching to use issue creation time","description":"get_copilot_workflow_run_id() returns most recent workflow without checking if it was created after the issue. This causes wrong labels when processing multiple issues concurrently. Fix: Get issue createdAt timestamp and filter workflows to only those created after the issue.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-13T14:49:55.706456Z","updated_at":"2026-01-13T14:53:19.316781Z","closed_at":"2026-01-13T14:53:19.316781Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-r6o","title":"Update troubleshooting-command-detection.md documentation","description":"Update docs/troubleshooting-command-detection.md: 1) Update all 9 scenarios with new behavior, 2) Add scenario for both phases failing, 3) Remove ConfigurationError exit references, 4) Update log message examples, 5) Add no-op fallback section explaining what happens and when.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-21T02:46:29.668335Z","updated_at":"2026-01-23T14:20:51.095459Z","closed_at":"2026-01-23T03:27:05.339630Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-r6o","depends_on_id":"contrast-ai-smartfix-action-bnk","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-rhm","title":"Use updatedAt instead of createdAt for workflow matching","description":"Change get_copilot_workflow_run_id() to use issue.updatedAt instead of createdAt. This captures the @copilot assignment event and is more accurate for when Copilot actually starts working.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T14:59:20.267808Z","updated_at":"2026-01-13T15:00:40.469323Z","closed_at":"2026-01-13T15:00:40.469323Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-rne","title":"Fix GitHub issue creation body escaping","description":"Fix gh issue create command failure by using --body-file pattern instead of --body. The issue body text bleeds into command arguments when it contains multi-line content or special characters. Mirror the proven pattern from create_claude_pr() method.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-12T20:48:04.268086Z","updated_at":"2026-01-12T20:54:32.793134Z","closed_at":"2026-01-12T20:54:32.793134Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-rpb","title":"Write unit tests for Phase 2 changes","description":"Create/update test_command_detection_agent.py to test: 1) Accepts Phase 1 failure history, 2) Returns None when exhausted (not exception), 3) Validation failures continue iterating, 4) Success returns command, 5) Mock SubAgentExecutor and run_build_command().","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-21T02:45:42.783851Z","updated_at":"2026-01-23T14:20:51.096122Z","closed_at":"2026-01-23T14:20:51.082836Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-rpb","depends_on_id":"contrast-ai-smartfix-action-9yb","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-tid","title":"Fix authorization bypass - fail closed on all errors","description":"Update count_open_prs_with_prefix to call error_exit on all API errors, not just auth errors. Prevents bypassing MAX_OPEN_PRS limits","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:18.249018Z","updated_at":"2026-01-13T20:56:33.869746Z","closed_at":"2026-01-13T20:56:33.869746Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-uoy","title":"Test smartfix_agent.py (25% → 70%)","description":"Add comprehensive tests for smartfix_agent.py remediation workflow state machine.\n\nCurrent coverage: 25%\nTarget: 70%\n\nCritical paths:\n- Initial build validation (pass/fail)\n- Fix agent execution (success/failure)\n- QA loop (success/retry/failure)\n- Session completion (all failure categories)\n\nTest cases:\n- Build fails before fix → INITIAL_BUILD_FAILURE\n- Fix agent succeeds, no build command → immediate success\n- Fix agent succeeds, QA passes → success\n- Fix agent succeeds, QA exhausts retries → QA_FAILURE\n- Fix agent throws exception → AGENT_FAILURE\n- Build never passes after fix → BUILD_FAILURE\n\nMocking:\n- _run_ai_fix_agent (return mock PR body or None)\n- _run_ai_qa_agent (return success/failure)\n- run_build_command (return success/failure + output)\n- All git operations\n\nReference: docs/plans/2026-01-05-test-coverage-improvement-design.md lines 78-99","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T21:38:29.814352Z","updated_at":"2026-01-06T19:43:29.354800Z","closed_at":"2026-01-06T19:43:29.354800Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-uoy","depends_on_id":"contrast-ai-smartfix-action-dtc","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-v7q","title":"Extract temp file handling to helper methods","description":"Create _write_to_temp_file and _cleanup_temp_file helpers. Refactor create_pr, create_claude_pr, create_issue to use helpers. Removes ~80 lines duplication","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:29.490013Z","updated_at":"2026-01-13T20:54:08.610376Z","closed_at":"2026-01-13T20:54:08.610376Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-wib","title":"Write integration tests for complete detection flow","description":"Create test_build_command_detection_integration.py to test: 1) Real Maven project (Phase 1 success), 2) Missing tools triggers Phase 2, 3) No markers triggers Phase 2, 4) Complete failure uses no-op fallback, 5) End-to-end flow validation.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-21T02:46:06.989131Z","updated_at":"2026-01-23T14:20:51.096755Z","closed_at":"2026-01-23T02:15:00Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-wib","depends_on_id":"contrast-ai-smartfix-action-bnk","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-wuv","title":"Update documentation for command allowlist","description":"Update README.md and related documentation:\n- Add new section explaining command allowlist security feature\n- Document all allowed commands organized by language/ecosystem\n- Document allowed operators for chaining (&&, ||, ;, |)\n- Document allowed redirect patterns (relative paths only)\n- Provide examples of valid commands for each language\n- Provide examples of blocked commands and why they fail\n- Document error messages users might encounter\n- Add troubleshooting section for common validation failures\n- Update security.md if present to mention this security feature\n\nRelated to JIRA: AIML-337","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T14:52:22.925762Z","updated_at":"2025-12-23T15:40:22.502328Z","closed_at":"2025-12-23T15:40:22.502328Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-ai-smartfix-action-wuv","depends_on_id":"contrast-ai-smartfix-action-q9y","type":"blocks","created_at":"2026-02-18T23:51:05Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-ai-smartfix-action-xs1","title":"Update documentation for fine-grained PAT permissions","description":"Update github_copilot.md and claude_code.md to include complete and accurate token permission requirements for fine-grained PATs. Add Contents (read-write) and Workflows (read) permissions that are currently missing.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T22:00:13.401461Z","updated_at":"2026-01-12T22:41:20.338025Z","closed_at":"2026-01-12T22:41:20.338025Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-xud","title":"Create edge case tests for monorepos","description":"Write tests for monorepo scenarios: multiple pom.xml files, nested build.gradle, workspace detection. Verify tool-specific directory flags (mvn -f, gradle -p, npm --prefix) are used correctly.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-16T02:46:40.173453Z","updated_at":"2026-01-16T20:43:14.166655Z","closed_at":"2026-01-16T20:43:14.166655Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-yas","title":"Add tests for find_pr_by_branch method","description":"Add unit tests: success case, not found, JSON decode error, command error, empty response","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T20:42:23.860478Z","updated_at":"2026-01-13T21:03:25.511569Z","closed_at":"2026-01-13T21:03:25.511569Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-yup","title":"Integrate command detection into Config.__init__()","description":"Add _auto_detect_build_command() and _auto_detect_format_command() methods to Config. Call during initialization when BUILD_COMMAND/FORMATTING_COMMAND not provided. Handle ConfigurationError on detection failure.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T02:44:31.234039Z","updated_at":"2026-01-16T21:00:30.056314Z","closed_at":"2026-01-16T21:00:30.056314Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-z4l","title":"Create LLM-as-judge prompt for E2E test repo PR reviews","description":"Create a reusable code review prompt for evaluating SmartFix's cybersecurity fixes in E2E test repos.\n\nPROMPT STRUCTURE:\n1. **Discovery Phase**\n   - Fetch open PRs using gh CLI\n   - Identify PRs created by SmartFix\n   - Extract vulnerability description from PR body\n   - Identify vulnerability type (SQL injection, XSS, path traversal, etc.)\n\n2. **Evaluation Criteria (Vulnerability-Agnostic)**\n   - Does the fix address the specific vulnerability described in PR body?\n   - Are all attack vectors for that vulnerability type blocked?\n   - Input validation appropriate for the vulnerability type\n   - Output encoding/sanitization where needed\n   - No introduction of new vulnerabilities\n   - Test coverage for the specific vulnerability\n\n3. **Review Process**\n   - Parse PR body to understand the vulnerability\n   - Fetch PR diff and files changed\n   - Analyze if code changes eliminate the vulnerability\n   - Check for incomplete fixes or edge cases\n   - **CRITICAL: If any problems are flagged:**\n     - Read surrounding code context (not just the diff)\n     - Trace the data flow to confirm the vulnerability path\n     - Verify the issue truly exists before reporting it\n     - Check if existing code already handles the concern\n     - Avoid false positives by validating assumptions\n   - Verify test cases cover the vulnerability scenario\n   - Assess if fix follows security best practices for that vuln type\n\n4. **Report Format**\n   - Vulnerability type and description (from PR)\n   - Fix effectiveness assessment\n   - Does fix address the vulnerability? (YES/NO/PARTIAL)\n   - Strengths of the fix\n   - Gaps or weaknesses in the fix (ONLY if confirmed by reading surrounding code)\n   - Attack vectors still exploitable (if any, with code evidence)\n   - Test coverage assessment\n   - Recommendations for improvement\n\nLOCATION:\ntest/prompts/smartfix-security-review.md\n\nUSAGE:\nUser runs Claude Code in E2E test repo and provides the prompt, which instructs Claude to review all open SmartFix PRs by matching code changes against the vulnerability described in each PR body.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T18:12:19.227567Z","updated_at":"2025-12-23T18:52:04.993954Z","closed_at":"2025-12-23T18:52:04.993954Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-ai-smartfix-action-zr8","title":"Create command_detector.py with deterministic layer","description":"Implement generate_build_command_candidates(), generate_format_command_candidates(), inspect_makefile_targets(), detect_package_manager(), and detect_build_command()/detect_format_command() functions with test-and-iterate logic.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T02:44:21.853441Z","updated_at":"2026-01-16T15:04:42.016829Z","closed_at":"2026-01-16T15:04:42.016829Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"contrast-cw3","title":"Stage 5a: google-adk incremental update (1.10.0 → 1.15.0)","description":"Branch: AIML-458_dependency-upgrades\n\nFILE CHANGES (src/requirements.txt):\n  google-adk==1.10.0 → google-adk==1.15.0\n\nAfter editing requirements.txt, regenerate the lock file:\n  uv pip compile src/requirements.txt -o src/requirements.lock\n\nREVIEW FIRST: Read google-adk changelog from 1.10.0 to 1.15.0 before making changes.\nKey files to audit for compatibility:\n  - src/smartfix/domains/agents/mcp_manager.py (MCPToolset usage)\n  - src/main.py (agent lifecycle, asyncio handling)\n  - Any file with: grep -r 'from google.adk' src/ OR grep -r 'import google.adk' src/\n\nTESTING GATE (all required before commit):\n  [ ] make test — all unit tests pass (especially test_agent_domain.py, test_agent_infrastructure.py)\n  [ ] make lint — no lint errors\n  [ ] Manual smoke test: trigger SmartFix, confirm agent runs to completion\n  [ ] Verify MCPToolset creation works (no API signature changes)\n  [ ] Verify tool calling works (agent can invoke file read/write tools)\n  [ ] Verify async/event loop behavior unchanged (no new warnings)\n  [ ] Check if Windows-specific asyncio patches in main.py still needed\n\nBREAKING CHANGE WATCH: MCPToolset constructor params, Agent API, asyncio policy changes.\nROLLBACK: Revert google-adk line to 1.10.0 and regenerate lock file.\nCOMMIT: Only after all gate items checked.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-18T23:30:18.197762Z","created_by":"jacobmages-haskins","updated_at":"2026-02-23T18:36:29.976261Z","closed_at":"2026-02-23T18:36:29.976198Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-cw3","depends_on_id":"contrast-2n9","type":"blocks","created_at":"2026-02-18T23:54:16Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"contrast-jst","title":"AIML-482 - Write unit tests for directory_tree_utils.py and smartfix_agent.py call sites","description":"Create test/test_directory_tree_utils.py with coverage for:\n\n1. get_directory_tree():\n   - 'tree' CLI available and succeeds → returns CLI output\n   - 'tree' CLI not found (FileNotFoundError) → falls back to generate_simple_tree()\n   - 'tree' CLI times out → falls back to generate_simple_tree()\n   - Output exceeds max_chars → truncated with '... [truncated, N chars omitted]' suffix\n   - Output within max_chars → not truncated\n\n2. generate_simple_tree():\n   - Empty directory → returns just the dir name\n   - Nested directories up to max_depth → correct tree symbols (├──, └──, │  )\n   - Skipped entries: .git, __pycache__, node_modules, .venv, venv, target, build, dist\n   - Skips .pyc files and .pytest_cache entries\n\n3. get_directory_tree_for_agent_prompt():\n   - Returns string starting with '\\n\\n## Repository Directory Tree\\n\\n'\n   - Tree content embedded between fences\n\nAlso update test/test_smartfix_agent.py:\n   - Existing tests that mock _run_fix_agent_execution or _run_qa_agent should still pass\n   - Verify get_directory_tree_for_agent_prompt is called once per agent invocation\n   - Verify the concatenated prompt string (with tree appended) is passed to _run_agent_in_event_loop\n\nTESTING GATE:\n  [ ] make test — all tests pass\n  [ ] make lint — no lint errors","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-23T18:34:42.827718Z","created_by":"jacobmages-haskins","updated_at":"2026-02-23T18:49:10.420474Z","closed_at":"2026-02-23T18:49:10.420455Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"contrast-jst","depends_on_id":"contrast-1e7","type":"blocks","created_at":"2026-02-23T18:34:54.105575Z","created_by":"jacobmages-haskins","metadata":"{}","thread_id":""},{"issue_id":"contrast-jst","depends_on_id":"contrast-29q","type":"blocks","created_at":"2026-02-23T18:34:54.139580Z","created_by":"jacobmages-haskins","metadata":"{}","thread_id":""}]}
